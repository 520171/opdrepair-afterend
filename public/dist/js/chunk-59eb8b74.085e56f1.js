(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59eb8b74"],{"469f":function(e,t,a){a("6c1c"),a("1654"),e.exports=a("7d7b")},5176:function(e,t,a){e.exports=a("51b6")},"51b6":function(e,t,a){a("a3c3"),e.exports=a("584a").Object.assign},"5d73":function(e,t,a){e.exports=a("469f")},6702:function(e,t,a){"use strict";var s=a("be58"),n=a.n(s);n.a},"7d7b":function(e,t,a){var s=a("e4ae"),n=a("7cd6");e.exports=a("584a").getIterator=function(e){var t=n(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return s(t.call(e))}},"7f7f":function(e,t,a){var s=a("86cc").f,n=Function.prototype,i=/^\s*function ([^ (]*)/,r="name";r in n||a("9e1e")&&s(n,r,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},9306:function(e,t,a){"use strict";var s=a("c3a1"),n=a("9aa9"),i=a("355d"),r=a("241e"),o=a("335c"),l=Object.assign;e.exports=!l||a("294c")(function(){var e={},t={},a=Symbol(),s="abcdefghijklmnopqrst";return e[a]=7,s.split("").forEach(function(e){t[e]=e}),7!=l({},e)[a]||Object.keys(l({},t)).join("")!=s})?function(e,t){var a=r(e),l=arguments.length,c=1,d=n.f,u=i.f;while(l>c){var m,g=o(arguments[c++]),f=d?s(g).concat(d(g)):s(g),p=f.length,h=0;while(p>h)u.call(g,m=f[h++])&&(a[m]=g[m])}return a}:l},a3c3:function(e,t,a){var s=a("63b6");s(s.S+s.F,"Object",{assign:a("9306")})},be58:function(e,t,a){},fa2d:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",[a("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[a("el-form",{attrs:{inline:!0,model:e.filters}},[a("el-form-item",[a("el-input",{attrs:{placeholder:"报修人姓名","prefix-icon":"el-icon-search"},model:{value:e.filters.name,callback:function(t){e.$set(e.filters,"name",t)},expression:"filters.name"}})],1),a("el-form-item",[a("el-date-picker",{attrs:{"prefix-icon":"el-icon-date",type:"daterange","start-placeholder":"开始日期","end-placeholder":"结束日期",size:"small","value-format":"yyyy/MM/dd","unlink-panels":""},on:{change:e.dateChange},model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.checkServices}},[e._v("查询")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.exportExcel}},[e._v("导出")])],1)],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.repairs,"highlight-current-row":""},on:{"selection-change":e.selsChange}},[e.showHidden?a("el-table-column",{attrs:{type:"selection","min-width":"60"}}):e._e(),a("el-table-column",{attrs:{type:"index","min-width":"100",index:20*(e.page-1)+1}}),a("el-table-column",{attrs:{prop:"u_name",label:"报修人姓名","min-width":"150",sortable:""}}),a("el-table-column",{attrs:{prop:"u_jobno",label:"报修人工号","min-width":"150",sortable:""}}),a("el-table-column",{attrs:{prop:"s_type",label:"报修类型","min-width":"150",formatter:e.formatType,sortable:""}}),a("el-table-column",{attrs:{prop:"s_date",label:"报修时间","min-width":"150",sortable:""}}),a("el-table-column",{attrs:{prop:"s_msg",label:"问题描述","min-width":"350",formatter:e.formatS_msg,sortable:""}}),a("el-table-column",{attrs:{label:"操作","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){return e.handleEdit(t.$index,t.row)}}},[e._v("详情")]),e.showHidden?a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.handleDel(t.$index,t.row)}}},[e._v("删除")]):e._e()]}}])})],1),a("el-col",{staticClass:"toolbar",attrs:{span:24}},[e.showHidden?a("el-button",{attrs:{type:"danger",disabled:0===this.sels.length},on:{click:e.batchRemove}},[e._v("批量删除")]):e._e(),a("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":20,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),a("el-dialog",{staticClass:"detail",attrs:{visible:e.repairMsgVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.repairMsgVisible=t}}},[a("div",[a("div",{staticClass:"userInfo"},[a("div",{staticClass:"msgTitle"},[e._v("报修人基本信息")]),a("div",{staticClass:"msg"},[e._v("工  号："+e._s(e.repairMsg.u_jobno))]),a("div",{staticClass:"msg"},[e._v("姓  名："+e._s(e.repairMsg.u_name))]),a("div",{staticClass:"msg"},[e._v("性  别："+e._s(e.repairMsg.u_gender?"男":"女"))]),a("div",{staticClass:"msg"},[e._v("所属部门："+e._s(e.repairMsg.d_name))])]),a("br"),a("div",{staticClass:"repairInfo"},[a("div",{staticClass:"msgTitle"},[e._v("报修内容")]),a("div",{staticClass:"msg"},[e._v("报修类型："+e._s(1===e.repairMsg.s_type?"电脑故障":2===e.repairMsg.s_type?"打印机故障":"其他问题"))]),a("div",{staticClass:"msg"},[e._v("报修时间："+e._s(e.repairMsg.s_date))]),a("div",{staticClass:"msg"},[e._v("问题描述："+e._s(e.repairMsg.s_msg))])]),a("br"),e.showAnnex?a("div",{staticClass:"annexInfo"},[a("div",{staticClass:"msgTitle"},[e._v("附件信息")]),a("div",{staticClass:"annex"},[e._l(e.picArr,function(e){return a("div",{key:e,staticClass:"box"},[a("el-image",{staticClass:"content",attrs:{src:e,"preview-src-list":[e]}})],1)}),e._l(e.videoArr,function(e){return a("div",{key:e,staticClass:"box"},[a("video",{staticClass:"content",staticStyle:{"max-width":"100%","max-height":"100%"},attrs:{src:e,controls:"controls"}})])})],2)]):e._e()])]),a("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[a("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[a("el-form-item",{attrs:{label:"姓名",prop:"name"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),a("el-form-item",{attrs:{label:"性别",prop:"sex"}},[a("el-radio-group",{model:{value:e.addForm.sex,callback:function(t){e.$set(e.addForm,"sex",t)},expression:"addForm.sex"}},[a("el-radio",{staticClass:"radio",attrs:{label:1}},[e._v("男")]),a("el-radio",{staticClass:"radio",attrs:{label:0}},[e._v("女")])],1)],1),a("el-form-item",{attrs:{label:"工号",prop:"jobNum"}},[a("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.jobNum,callback:function(t){e.$set(e.addForm,"jobNum",t)},expression:"addForm.jobNum"}})],1),a("el-form-item",{attrs:{label:"部门",prop:"d_no"}},[a("el-select",{attrs:{placeholder:"请选择",filterable:"",clearable:""},model:{value:e.addForm.d_no,callback:function(t){e.$set(e.addForm,"d_no",t)},expression:"addForm.d_no"}},e._l(this.$store.state.departments,function(e){return a("el-option",{key:e.d_name,attrs:{label:e.d_name,value:e.d_no}})}),1)],1)],1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),a("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1)],1)},n=[],i=(a("7f7f"),a("5d73")),r=a.n(i),o=a("5176"),l=a.n(o),c=a("4ec3");function d(e,t){a.e("chunk-0e6cc4bd").then(function(){var s=a("39a0"),n=s.export_json_to_excel,i=[],r=[];e.forEach(function(e){i.push(e.title),r.push(e.key)});var o=t.map(function(e){return r.map(function(t){return e[t]})});n(i,o,"数据列表")}.bind(null,a)).catch(a.oe)}var u={props:{showHidden:{default:!0,type:Boolean}},data:function(){return{filters:{name:""},repairs:[],total:0,page:1,listLoading:!1,sels:[],repairMsgVisible:!1,editLoading:!1,showAnnex:!1,repairMsg:{u_name:"",u_gender:-1,u_jobno:"",u_id:"",d_no:"",d_name:"",d_id:"",s_id:"",s_msg:"",s_date:"",s_type:""},addFormVisible:!1,addLoading:!1,addFormRules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],jobNum:[{required:!0,message:"工号不能为空",trigger:"blur"}],d_no:[{required:!0,message:"部门不能为空",trigger:"blur"}]},addForm:{name:"",sex:-1,jobNum:"",d_no:""},picArr:[],videoArr:[],size:0,rangeDate:null,excelFormateData:[{title:"报修人姓名",key:"u_name"},{title:"报修人工号",key:"u_jobno"},{title:"报修人所属部门",key:"d_name"},{title:"报修类型",key:"t_name"},{title:"报修时间",key:"s_date"},{title:"问题描述",key:"s_msg"}],username:""}},methods:{formatS_msg:function(e,t){return e.s_msg.length>20?"".concat(e.s_msg.substr(0,20),"..."):e.s_msg},formatSex:function(e,t){return 1===e.u_gender?"男":0===e.u_gender?"女":"未知"},formatType:function(e,t){return 1===e.s_type?"电脑故障":2===e.s_type?"打印机故障":"其他问题"},handleCurrentChange:function(e){this.page=e,this.getServices()},getServices:function(){var e=this,t={page:this.page,name:this.username,date:this.rangeDate};this.listLoading=!0,Object(c["f"])(t).then(function(t){e.total=t.data.total,e.repairs=t.data.repairs,e.listLoading=!1}).catch(function(t){console.log(t),e.listLoading=!1})},handleDel:function(e,t){var a=this;this.$confirm("确认删除该条报修记录吗?","提示",{type:"warning"}).then(function(){a.listLoading=!0;var e={id:t.s_id};Object(c["i"])(e).then(function(e){200===e.data.code?(a.listLoading=!1,a.$message({message:"删除成功",type:"success"}),a.getServices()):(a.listLoading=!1,a.$message({message:"删除失败",type:"error"}))}).catch(function(e){console.log(e),a.listLoading=!1,a.$message({message:"删除失败",type:"error"})})})},handleEdit:function(e,t){this.repairMsgVisible=!0,this.repairMsg=l()({},t),this.obtainAnnexes(t.s_id)},handleAdd:function(){this.addFormVisible=!0,this.addForm={name:"",sex:-1,jobNum:"",d_no:""}},editSubmit:function(){var e=this;this.$refs.repairMsg.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0;var t=l()({},e.repairMsg);Object(c["c"])(t).then(function(t){200===t.data.code?(e.editLoading=!1,e.$message({message:"提交成功",type:"success"}),e.$refs["repairMsg"].resetFields(),e.repairMsgVisible=!1,e.getServices()):(e.editLoading=!1,e.$message({message:"提交失败",type:"error"}))}).catch(function(t){console.log(t),e.editLoading=!1,e.$message({message:"提交失败",type:"error"})})})})},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.addLoading=!0;var t=l()({},e.addForm);Object(c["b"])(t).then(function(t){200===t.data.code?(e.addLoading=!1,e.$message({message:"提交成功",type:"success"}),e.$refs["addForm"].resetFields(),e.addFormVisible=!1,e.getServices()):(e.addLoading=!1,e.$message({message:"提交失败",type:"error"}))}).catch(function(t){console.log(t),e.addLoading=!1,e.$message({message:"提交失败",type:"error"})})})})},selsChange:function(e){this.sels=e},batchRemove:function(){var e=this,t=this.sels.map(function(e){return e.s_id});this.$confirm("确认删除选中的记录吗？","提示",{type:"warning"}).then(function(){e.listLoading=!0;var a={id:t};Object(c["i"])(a).then(function(t){200===t.data.code?(e.listLoading=!1,e.$message({message:"删除成功",type:"success"}),e.getServices()):(e.listLoading=!1,e.$message({message:"删除失败",type:"error"}))}).catch(function(t){console.log(t),e.listLoading=!1,e.$message({message:"删除失败",type:"error"})})})},obtainAnnexes:function(e){var t=this;Object(c["d"])(e).then(function(e){"fail"!=e.data.message?0===e.data.message.length?t.showAnnex=!1:(t.showAnnex=!0,t.handleAnnex(e.data.message)):t.showAnnex=!1}).catch(function(e){console.log("错误信息：".concat(e)),t.showAnnex=!1})},handleAnnex:function(e){this.picArr.length=0,this.videoArr.length=0;var t=!0,a=!1,s=void 0;try{for(var n,i=r()(e);!(t=(n=i.next()).done);t=!0){var o=n.value;o.a_isImg?this.picArr.push(o.a_url):this.videoArr.push(o.a_url)}}catch(l){a=!0,s=l}finally{try{t||null==i.return||i.return()}finally{if(a)throw s}}},exportExcel:function(){var e=this;Object(c["l"])({name:this.username,date:this.rangeDate}).then(function(t){200==t.data.code&&d(e.excelFormateData,t.data.msg)}).catch(function(e){console.log(e)})},dateChange:function(){this.getServices()},checkServices:function(){this.username=this.filters.name,this.getServices()}},mounted:function(){this.getServices()}},m=u,g=(a("6702"),a("2877")),f=Object(g["a"])(m,s,n,!1,null,null,null);t["default"]=f.exports}}]);