(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-87f174dc"],{"40c3":function(e,t,s){var a=s("6b4c"),i=s("5168")("toStringTag"),n="Arguments"==a(function(){return arguments}()),r=function(e,t){try{return e[t]}catch(s){}};e.exports=function(e){var t,s,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(s=r(t=Object(e),i))?s:n?a(t):"Object"==(o=a(t))&&"function"==typeof t.callee?"Arguments":o}},"469f":function(e,t,s){s("6c1c"),s("1654"),e.exports=s("7d7b")},"5d73":function(e,t,s){e.exports=s("469f")},6702:function(e,t,s){"use strict";var a=s("be58"),i=s.n(a);i.a},"7cd6":function(e,t,s){var a=s("40c3"),i=s("5168")("iterator"),n=s("481b");e.exports=s("584a").getIteratorMethod=function(e){if(void 0!=e)return e[i]||e["@@iterator"]||n[a(e)]}},"7d7b":function(e,t,s){var a=s("e4ae"),i=s("7cd6");e.exports=s("584a").getIterator=function(e){var t=i(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return a(t.call(e))}},be58:function(e,t,s){},fa2d:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",[s("el-col",{staticClass:"toolbar",staticStyle:{"padding-bottom":"0px"},attrs:{span:24}},[s("el-form",{attrs:{inline:!0,model:e.filters}},[s("el-form-item",[s("el-input",{attrs:{placeholder:"报修人姓名"},model:{value:e.filters.name,callback:function(t){e.$set(e.filters,"name",t)},expression:"filters.name"}})],1),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.getServices}},[e._v("查询")])],1)],1)],1),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:e.repairs,"highlight-current-row":""},on:{"selection-change":e.selsChange}},[e.showHidden?s("el-table-column",{attrs:{type:"selection","min-width":"60"}}):e._e(),s("el-table-column",{attrs:{type:"index","min-width":"100"}}),s("el-table-column",{attrs:{prop:"u_name",label:"报修人姓名","min-width":"150"}}),s("el-table-column",{attrs:{prop:"u_jobno",label:"报修人工号","min-width":"150"}}),s("el-table-column",{attrs:{prop:"s_type",label:"报修类型","min-width":"150",formatter:e.formatType}}),s("el-table-column",{attrs:{prop:"s_date",label:"报修时间","min-width":"150"}}),s("el-table-column",{attrs:{prop:"s_msg",label:"问题描述","min-width":"350",formatter:e.formatS_msg}}),s("el-table-column",{attrs:{label:"操作","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{size:"small"},on:{click:function(s){return e.handleEdit(t.$index,t.row)}}},[e._v("详情")]),e.showHidden?s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(s){return e.handleDel(t.$index,t.row)}}},[e._v("删除")]):e._e()]}}])})],1),s("el-col",{staticClass:"toolbar",attrs:{span:24}},[e.showHidden?s("el-button",{attrs:{type:"danger",disabled:0===this.sels.length},on:{click:e.batchRemove}},[e._v("批量删除")]):e._e(),s("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":20,total:e.total},on:{"current-change":e.handleCurrentChange}})],1),s("el-dialog",{staticClass:"detail",attrs:{visible:e.repairMsgVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.repairMsgVisible=t}}},[s("div",[s("div",[s("div",{staticClass:"msgTitle"},[e._v("报修人基本信息")]),s("div",{staticClass:"msg"},[e._v("姓  名："+e._s(e.repairMsg.u_name))]),s("div",{staticClass:"msg"},[e._v("性  别："+e._s(e.repairMsg.u_gender?"男":"女"))]),s("div",{staticClass:"msg"},[e._v("工  号："+e._s(e.repairMsg.u_jobno))]),s("div",{staticClass:"msg"},[e._v("所属部门："+e._s(e.repairMsg.d_name))])]),s("br"),s("div",[s("div",{staticClass:"msgTitle"},[e._v("报修内容")]),s("div",{staticClass:"msg"},[e._v("报修类型："+e._s(1===e.repairMsg.s_type?"电脑故障":2===e.repairMsg.s_type?"打印机故障":"其他问题"))]),s("div",{staticClass:"msg"},[e._v("报修时间："+e._s(e.repairMsg.s_date))]),s("div",{staticClass:"msg"},[e._v("问题描述："+e._s(e.repairMsg.s_msg))])]),s("br"),e.showAnnex?s("div",[s("div",{staticClass:"msgTitle"},[e._v("附件信息")]),s("vue-viewer",{attrs:{images:e.picArr}},[s("div",{staticClass:"annex"},[e._l(e.picArr,function(e){return s("div",{key:e,staticClass:"box"},[s("img",{staticClass:"content",attrs:{src:e}})])}),e._l(e.videoArr,function(e){return s("div",{key:e,staticClass:"box"},[s("video",{staticClass:"content",staticStyle:{"max-width":"100%","max-height":"100%"},attrs:{src:e,controls:"controls"}})])})],2)])],1):e._e()])]),s("el-dialog",{attrs:{title:"新增",visible:e.addFormVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addFormVisible=t}}},[s("el-form",{ref:"addForm",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[s("el-form-item",{attrs:{label:"姓名",prop:"name"}},[s("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.name,callback:function(t){e.$set(e.addForm,"name",t)},expression:"addForm.name"}})],1),s("el-form-item",{attrs:{label:"性别",prop:"sex"}},[s("el-radio-group",{model:{value:e.addForm.sex,callback:function(t){e.$set(e.addForm,"sex",t)},expression:"addForm.sex"}},[s("el-radio",{staticClass:"radio",attrs:{label:1}},[e._v("男")]),s("el-radio",{staticClass:"radio",attrs:{label:0}},[e._v("女")])],1)],1),s("el-form-item",{attrs:{label:"工号",prop:"jobNum"}},[s("el-input",{attrs:{"auto-complete":"off"},model:{value:e.addForm.jobNum,callback:function(t){e.$set(e.addForm,"jobNum",t)},expression:"addForm.jobNum"}})],1),s("el-form-item",{attrs:{label:"部门",prop:"d_no"}},[s("el-select",{attrs:{placeholder:"请选择",filterable:"",clearable:""},model:{value:e.addForm.d_no,callback:function(t){e.$set(e.addForm,"d_no",t)},expression:"addForm.d_no"}},e._l(this.$store.state.departments,function(e){return s("el-option",{key:e.d_name,attrs:{label:e.d_name,value:e.d_no}})}),1)],1)],1),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{nativeOn:{click:function(t){e.addFormVisible=!1}}},[e._v("取消")]),s("el-button",{attrs:{type:"primary",loading:e.addLoading},nativeOn:{click:function(t){return e.addSubmit(t)}}},[e._v("提交")])],1)],1)],1)},i=[],n=s("5d73"),r=s.n(n),o=s("5176"),l=s.n(o),d=(s("7f7f"),s("4ec3")),c=s("921e"),m=s.n(c),u={components:{VueViewer:m.a},props:{showHidden:{default:!0,type:Boolean}},data:function(){return{filters:{name:""},repairs:[],total:0,page:1,listLoading:!1,sels:[],repairMsgVisible:!1,editLoading:!1,showAnnex:!1,repairMsg:{u_name:"",u_gender:-1,u_jobno:"",u_id:"",d_no:"",d_name:"",d_id:"",s_id:"",s_msg:"",s_date:"",s_type:""},addFormVisible:!1,addLoading:!1,addFormRules:{name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],jobNum:[{required:!0,message:"工号不能为空",trigger:"blur"}],d_no:[{required:!0,message:"部门不能为空",trigger:"blur"}]},addForm:{name:"",sex:-1,jobNum:"",d_no:""},picArr:[],videoArr:[],size:0}},methods:{formatS_msg:function(e,t){return e.s_msg.length>20?"".concat(e.s_msg.substr(0,20),"..."):e.s_msg},formatSex:function(e,t){return 1===e.u_gender?"男":0===e.u_gender?"女":"未知"},formatType:function(e,t){return 1===e.s_type?"电脑故障":2===e.s_type?"打印机故障":"其他问题"},handleCurrentChange:function(e){this.page=e,this.getServices()},getServices:function(){var e=this,t={page:this.page,name:this.filters.name};this.listLoading=!0,Object(d["f"])(t).then(function(t){e.total=t.data.total,e.repairs=t.data.repairs,e.listLoading=!1}).catch(function(t){console.log(t),e.listLoading=!1})},handleDel:function(e,t){var s=this;this.$confirm("确认删除该条报修记录吗?","提示",{type:"warning"}).then(function(){s.listLoading=!0;var e={id:t.s_id};Object(d["i"])(e).then(function(e){200===e.data.code?(s.listLoading=!1,s.$message({message:"删除成功",type:"success"}),s.getServices()):(s.listLoading=!1,s.$message({message:"删除失败",type:"error"}))}).catch(function(e){console.log(e),s.listLoading=!1,s.$message({message:"删除失败",type:"error"})})})},handleEdit:function(e,t){this.repairMsgVisible=!0,this.repairMsg=l()({},t),this.obtainAnnexes(t.s_id)},handleAdd:function(){this.addFormVisible=!0,this.addForm={name:"",sex:-1,jobNum:"",d_no:""}},editSubmit:function(){var e=this;this.$refs.repairMsg.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.editLoading=!0;var t=l()({},e.repairMsg);Object(d["c"])(t).then(function(t){200===t.data.code?(e.editLoading=!1,e.$message({message:"提交成功",type:"success"}),e.$refs["repairMsg"].resetFields(),e.repairMsgVisible=!1,e.getServices()):(e.editLoading=!1,e.$message({message:"提交失败",type:"error"}))}).catch(function(t){console.log(t),e.editLoading=!1,e.$message({message:"提交失败",type:"error"})})})})},addSubmit:function(){var e=this;this.$refs.addForm.validate(function(t){t&&e.$confirm("确认提交吗？","提示",{}).then(function(){e.addLoading=!0;var t=l()({},e.addForm);Object(d["b"])(t).then(function(t){200===t.data.code?(e.addLoading=!1,e.$message({message:"提交成功",type:"success"}),e.$refs["addForm"].resetFields(),e.addFormVisible=!1,e.getServices()):(e.addLoading=!1,e.$message({message:"提交失败",type:"error"}))}).catch(function(t){console.log(t),e.addLoading=!1,e.$message({message:"提交失败",type:"error"})})})})},selsChange:function(e){this.sels=e},batchRemove:function(){var e=this,t=this.sels.map(function(e){return e.s_id});this.$confirm("确认删除选中的记录吗？","提示",{type:"warning"}).then(function(){e.listLoading=!0;var s={id:t};Object(d["i"])(s).then(function(t){200===t.data.code?(e.listLoading=!1,e.$message({message:"删除成功",type:"success"}),e.getServices()):(e.listLoading=!1,e.$message({message:"删除失败",type:"error"}))}).catch(function(t){console.log(t),e.listLoading=!1,e.$message({message:"删除失败",type:"error"})})})},obtainAnnexes:function(e){var t=this;Object(d["d"])(e).then(function(e){"fail"!=e.data.message?0===e.data.message.length?t.showAnnex=!1:(t.showAnnex=!0,t.handleAnnex(e.data.message)):t.showAnnex=!1}).catch(function(e){console.log("错误信息：".concat(e)),t.showAnnex=!1})},handleAnnex:function(e){this.picArr.length=0,this.videoArr.length=0;var t=!0,s=!1,a=void 0;try{for(var i,n=r()(e);!(t=(i=n.next()).done);t=!0){var o=i.value;o.a_isImg?this.picArr.push(o.a_url):this.videoArr.push(o.a_url)}}catch(l){s=!0,a=l}finally{try{t||null==n.return||n.return()}finally{if(s)throw a}}console.log(this.picArr),console.log(this.videoArr)}},mounted:function(){this.getServices()}},g=u,p=(s("6702"),s("2877")),f=Object(p["a"])(g,a,i,!1,null,null,null);t["default"]=f.exports}}]);
//# sourceMappingURL=chunk-87f174dc.fbfcfb24.js.map